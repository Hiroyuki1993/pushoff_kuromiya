# Crane Challenge Round1 黒宮
## 発達心理学的なバックグラウンド
ピアジェの『発生的認識論』
https://docs.google.com/presentation/d/1gbud1U1vlG9NkaZqfUMHHUfbjR5iDoXvSDOued8R2Ds/edit?usp=sharing

物理法則の認識には因果関係の理解が重要(**具体的操作期**：9~10歳くらい)

しかし生後まもなくの赤ちゃんにも因果関係の理解力が備わっているという知見もある

### ex.モビール課題([Watanabe, 2009](http://www.sciencedirect.com/science/article/pii/S0163638308001112))
![figure1](http://ars.els-cdn.com/content/image/1-s2.0-S0163638308001112-gr1.jpg)

赤ちゃんの手の片方に糸でモビールを結びつけると、結んだ側の手がそうでない手に比べてよく動くようになる

![figure2](http://ars.els-cdn.com/content/image/1-s2.0-S0163638308001112-gr3.jpg)

(引用論文ではAL条件とLA条件の比較がメインですが)赤色のグラフを見ると、紐が結びついているときはBaselineよりもよく手を動かしていることが分かる。

つまり __赤ちゃんは自分が動くことによって環境が変化するとその行動が強化されるようになり__ こうした外界への働きかけを通じて因果関係の理解が促進されるのではないかということが言える

## 今回のコンセプト
上記のような知見に基づき、落とした時にもらえる報酬の代わりに自分が動いた時にサイコロも動くと報酬がもらえるようにした。
具体的には自分の動きのベクトルとサイコロの動きのベクトルのコサイン距離を報酬にし、自分の動きとサイコロの動きが同じであれば正の報酬（左図）、サイコロが動いていたとしても自分の動きとは無関係の場合は報酬０（右図）が与えられるようにした。

![figure3](https://docs.google.com/drawings/d/1FpnXTANDI_mWe0Tli5q8tpTR1Op9_q9mTwQhJiNcdSw/pub?w=480&amp;h=360)

## 実装
不完全ではあるがobservationに含まれているextra['choord']から（０でない）サイコロの座標を取得し、前回の座標との差を取り動きのベクトルを算出。正規化した後エージェントの動き（xz平面４通り）との内積をとりこの値を報酬としている。
強化学習の部分にはchainerrlを用いた。
ソースはcos.py

## 現在の進捗状況
3000ステップまで学習を進めているが、あまり上手く訓練できていない。
棒でサイコロを押しているときに１に近い報酬が与えられて、空振りのときは報酬0、また負の報酬はほとんど見られないため報酬の設定自体はできていると思われるが、主として挑戦者のDQNに対する理解不足のためかエージェントが意図的にサイコロに向かうような動きは見られない。

## 注釈
+ 画像をobservationにしていないので、もともとサイコロの数が変わると対応できないという問題を含んでいる
+ サイコロに触れたら報酬なので、落とす動きが獲得できるのかは分からない
